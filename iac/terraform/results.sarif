{"$schema": "https://raw.githubusercontent.com/oasis-tcs/sarif-spec/main/sarif-2.1/schema/sarif-schema-2.1.0.json", "version": "2.1.0", "runs": [{"tool": {"driver": {"name": "Checkov", "version": "3.2.497", "informationUri": "https://checkov.io", "rules": [{"id": "CKV_AZURE_10", "name": "Ensure that SSH access is restricted from the internet", "shortDescription": {"text": "Ensure that SSH access is restricted from the internet"}, "fullDescription": {"text": "Ensure that SSH access is restricted from the internet"}, "help": {"text": "Ensure that SSH access is restricted from the internet\nResource: azurerm_network_security_group.nsg"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-networking-policies/bc-azr-networking-3"}, {"id": "GR_AZURE_001", "name": "Disallow SSH (22) from Internet on NSG rules", "shortDescription": {"text": "Disallow SSH (22) from Internet on NSG rules"}, "fullDescription": {"text": "Disallow SSH (22) from Internet on NSG rules"}, "help": {"text": "Disallow SSH (22) from Internet on NSG rules\nResource: azurerm_network_security_group.nsg"}, "defaultConfiguration": {"level": "error"}}, {"id": "CKV_AZURE_33", "name": "Ensure Storage logging is enabled for Queue service for read, write and delete requests", "shortDescription": {"text": "Ensure Storage logging is enabled for Queue service for read, write and delete requests"}, "fullDescription": {"text": "Ensure Storage logging is enabled for Queue service for read, write and delete requests"}, "help": {"text": "Ensure Storage logging is enabled for Queue service for read, write and delete requests\nResource: azurerm_storage_account.st"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-logging-policies/enable-requests-on-storage-logging-for-queue-service"}, {"id": "CKV_AZURE_190", "name": "Ensure that Storage blobs restrict public access", "shortDescription": {"text": "Ensure that Storage blobs restrict public access"}, "fullDescription": {"text": "Ensure that Storage blobs restrict public access"}, "help": {"text": "Ensure that Storage blobs restrict public access\nResource: azurerm_storage_account.st"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-networking-policies/azr-networking-190"}, {"id": "CKV_AZURE_206", "name": "Ensure that Storage Accounts use replication", "shortDescription": {"text": "Ensure that Storage Accounts use replication"}, "fullDescription": {"text": "Ensure that Storage Accounts use replication"}, "help": {"text": "Ensure that Storage Accounts use replication\nResource: azurerm_storage_account.st"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/azr-general-206"}, {"id": "CKV_AZURE_59", "name": "Ensure that Storage accounts disallow public access", "shortDescription": {"text": "Ensure that Storage accounts disallow public access"}, "fullDescription": {"text": "Ensure that Storage accounts disallow public access"}, "help": {"text": "Ensure that Storage accounts disallow public access\nResource: azurerm_storage_account.st"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-networking-policies/ensure-that-storage-accounts-disallow-public-access"}, {"id": "CKV_AZURE_44", "name": "Ensure Storage Account is using the latest version of TLS encryption", "shortDescription": {"text": "Ensure Storage Account is using the latest version of TLS encryption"}, "fullDescription": {"text": "Ensure Storage Account is using the latest version of TLS encryption"}, "help": {"text": "Ensure Storage Account is using the latest version of TLS encryption\nResource: azurerm_storage_account.st"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-storage-policies/bc-azr-storage-2"}, {"id": "GR_AZURE_003", "name": "Storage must require TLS 1.2 minimum", "shortDescription": {"text": "Storage must require TLS 1.2 minimum"}, "fullDescription": {"text": "Storage must require TLS 1.2 minimum"}, "help": {"text": "Storage must require TLS 1.2 minimum\nResource: azurerm_storage_account.st"}, "defaultConfiguration": {"level": "error"}}, {"id": "GR_AZURE_002", "name": "Storage must disable public network access", "shortDescription": {"text": "Storage must disable public network access"}, "fullDescription": {"text": "Storage must disable public network access"}, "help": {"text": "Storage must disable public network access\nResource: azurerm_storage_account.st"}, "defaultConfiguration": {"level": "error"}}, {"id": "CKV_AZURE_34", "name": "Ensure that 'Public access level' is set to Private for blob containers", "shortDescription": {"text": "Ensure that 'Public access level' is set to Private for blob containers"}, "fullDescription": {"text": "Ensure that 'Public access level' is set to Private for blob containers"}, "help": {"text": "Ensure that 'Public access level' is set to Private for blob containers\nResource: azurerm_storage_container.public_container"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-networking-policies/set-public-access-level-to-private-for-blob-containers"}], "organization": "bridgecrew"}}, "results": [{"ruleId": "CKV_AZURE_10", "ruleIndex": 0, "level": "error", "attachments": [], "message": {"text": "Ensure that SSH access is restricted from the internet"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "bad/main.tf"}, "region": {"startLine": 22, "endLine": 38, "snippet": {"text": "resource \"azurerm_network_security_group\" \"nsg\" {\n  name                = \"nsg-bad\"\n  location            = azurerm_resource_group.rg.location\n  resource_group_name = azurerm_resource_group.rg.name\n\n  security_rule {\n    name                       = \"Allow-SSH-From-Internet\"\n    priority                   = 100\n    direction                  = \"Inbound\"\n    access                     = \"Allow\"\n    protocol                   = \"Tcp\"\n    source_port_range          = \"*\"\n    destination_port_range     = \"22\"\n    source_address_prefix      = \"*\"\n    destination_address_prefix = \"*\"\n  }\n}\n"}}}}]}, {"ruleId": "GR_AZURE_001", "ruleIndex": 1, "level": "error", "attachments": [], "message": {"text": "Disallow SSH (22) from Internet on NSG rules"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "bad/main.tf"}, "region": {"startLine": 22, "endLine": 38, "snippet": {"text": "resource \"azurerm_network_security_group\" \"nsg\" {\n  name                = \"nsg-bad\"\n  location            = azurerm_resource_group.rg.location\n  resource_group_name = azurerm_resource_group.rg.name\n\n  security_rule {\n    name                       = \"Allow-SSH-From-Internet\"\n    priority                   = 100\n    direction                  = \"Inbound\"\n    access                     = \"Allow\"\n    protocol                   = \"Tcp\"\n    source_port_range          = \"*\"\n    destination_port_range     = \"22\"\n    source_address_prefix      = \"*\"\n    destination_address_prefix = \"*\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AZURE_33", "ruleIndex": 2, "level": "error", "attachments": [], "message": {"text": "Ensure Storage logging is enabled for Queue service for read, write and delete requests"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "bad/main.tf"}, "region": {"startLine": 41, "endLine": 53, "snippet": {"text": "resource \"azurerm_storage_account\" \"st\" {\n  name                            = \"stguardrailbad12345\"\n  resource_group_name             = azurerm_resource_group.rg.name\n  location                        = azurerm_resource_group.rg.location\n  account_tier                    = \"Standard\"\n  account_replication_type        = \"LRS\"\n\n  # Insecure settings (intentionally):\n  https_traffic_only_enabled      = false\n  min_tls_version                 = \"TLS1_0\"\n  public_network_access_enabled   = true\n  allow_nested_items_to_be_public = true\n}\n"}}}}]}, {"ruleId": "CKV_AZURE_190", "ruleIndex": 3, "level": "error", "attachments": [], "message": {"text": "Ensure that Storage blobs restrict public access"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "bad/main.tf"}, "region": {"startLine": 41, "endLine": 53, "snippet": {"text": "resource \"azurerm_storage_account\" \"st\" {\n  name                            = \"stguardrailbad12345\"\n  resource_group_name             = azurerm_resource_group.rg.name\n  location                        = azurerm_resource_group.rg.location\n  account_tier                    = \"Standard\"\n  account_replication_type        = \"LRS\"\n\n  # Insecure settings (intentionally):\n  https_traffic_only_enabled      = false\n  min_tls_version                 = \"TLS1_0\"\n  public_network_access_enabled   = true\n  allow_nested_items_to_be_public = true\n}\n"}}}}]}, {"ruleId": "CKV_AZURE_206", "ruleIndex": 4, "level": "error", "attachments": [], "message": {"text": "Ensure that Storage Accounts use replication"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "bad/main.tf"}, "region": {"startLine": 41, "endLine": 53, "snippet": {"text": "resource \"azurerm_storage_account\" \"st\" {\n  name                            = \"stguardrailbad12345\"\n  resource_group_name             = azurerm_resource_group.rg.name\n  location                        = azurerm_resource_group.rg.location\n  account_tier                    = \"Standard\"\n  account_replication_type        = \"LRS\"\n\n  # Insecure settings (intentionally):\n  https_traffic_only_enabled      = false\n  min_tls_version                 = \"TLS1_0\"\n  public_network_access_enabled   = true\n  allow_nested_items_to_be_public = true\n}\n"}}}}]}, {"ruleId": "CKV_AZURE_59", "ruleIndex": 5, "level": "error", "attachments": [], "message": {"text": "Ensure that Storage accounts disallow public access"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "bad/main.tf"}, "region": {"startLine": 41, "endLine": 53, "snippet": {"text": "resource \"azurerm_storage_account\" \"st\" {\n  name                            = \"stguardrailbad12345\"\n  resource_group_name             = azurerm_resource_group.rg.name\n  location                        = azurerm_resource_group.rg.location\n  account_tier                    = \"Standard\"\n  account_replication_type        = \"LRS\"\n\n  # Insecure settings (intentionally):\n  https_traffic_only_enabled      = false\n  min_tls_version                 = \"TLS1_0\"\n  public_network_access_enabled   = true\n  allow_nested_items_to_be_public = true\n}\n"}}}}]}, {"ruleId": "CKV_AZURE_44", "ruleIndex": 6, "level": "error", "attachments": [], "message": {"text": "Ensure Storage Account is using the latest version of TLS encryption"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "bad/main.tf"}, "region": {"startLine": 41, "endLine": 53, "snippet": {"text": "resource \"azurerm_storage_account\" \"st\" {\n  name                            = \"stguardrailbad12345\"\n  resource_group_name             = azurerm_resource_group.rg.name\n  location                        = azurerm_resource_group.rg.location\n  account_tier                    = \"Standard\"\n  account_replication_type        = \"LRS\"\n\n  # Insecure settings (intentionally):\n  https_traffic_only_enabled      = false\n  min_tls_version                 = \"TLS1_0\"\n  public_network_access_enabled   = true\n  allow_nested_items_to_be_public = true\n}\n"}}}}]}, {"ruleId": "GR_AZURE_003", "ruleIndex": 7, "level": "error", "attachments": [], "message": {"text": "Storage must require TLS 1.2 minimum"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "bad/main.tf"}, "region": {"startLine": 41, "endLine": 53, "snippet": {"text": "resource \"azurerm_storage_account\" \"st\" {\n  name                            = \"stguardrailbad12345\"\n  resource_group_name             = azurerm_resource_group.rg.name\n  location                        = azurerm_resource_group.rg.location\n  account_tier                    = \"Standard\"\n  account_replication_type        = \"LRS\"\n\n  # Insecure settings (intentionally):\n  https_traffic_only_enabled      = false\n  min_tls_version                 = \"TLS1_0\"\n  public_network_access_enabled   = true\n  allow_nested_items_to_be_public = true\n}\n"}}}}]}, {"ruleId": "GR_AZURE_002", "ruleIndex": 8, "level": "error", "attachments": [], "message": {"text": "Storage must disable public network access"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "bad/main.tf"}, "region": {"startLine": 41, "endLine": 53, "snippet": {"text": "resource \"azurerm_storage_account\" \"st\" {\n  name                            = \"stguardrailbad12345\"\n  resource_group_name             = azurerm_resource_group.rg.name\n  location                        = azurerm_resource_group.rg.location\n  account_tier                    = \"Standard\"\n  account_replication_type        = \"LRS\"\n\n  # Insecure settings (intentionally):\n  https_traffic_only_enabled      = false\n  min_tls_version                 = \"TLS1_0\"\n  public_network_access_enabled   = true\n  allow_nested_items_to_be_public = true\n}\n"}}}}]}, {"ruleId": "CKV_AZURE_34", "ruleIndex": 9, "level": "error", "attachments": [], "message": {"text": "Ensure that 'Public access level' is set to Private for blob containers"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "bad/main.tf"}, "region": {"startLine": 56, "endLine": 60, "snippet": {"text": "resource \"azurerm_storage_container\" \"public_container\" {\n  name                  = \"public\"\n  storage_account_name  = azurerm_storage_account.st.name\n  container_access_type = \"blob\"\n}\n"}}}}]}]}]}